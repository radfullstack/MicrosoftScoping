<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Scoping</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        .col input, .col select, .col textarea {
            max-width: 550px;
            margin-left: auto;
        }
        .control-label {
            transition: all .3s;
        }
        .main {
            margin:0;
        }
        .form-panel {
            background: #766061;
            color:white;
        }
        .btn-primary, .btn-primary:focus {
            background: #766061;
            outline: none;
            box-shadow: none;
            border: 1px solid #5e4d4e;
        }
        .btn-primary:hover {
            background: #5e4d4e;
            border: 1px solid #362c2c;
        }
        .btn-success, .btn-success:focus {
            background: #805f61;
            outline: none;
            box-shadow: none;
            border: 1px solid #3d2929;
        }
        .btn-success:hover {
            background: #805f61;
            border: 1px solid #3d2929;
        }
        .btn-success {
            opacity:1;
        }
        .btn-link {
            background: transparent;
            border: none;
            outline: none;
            color: white;
            padding:4px 15px;
            font-size: 22px;
        }
        .btn-link:hover {
            color: black;
        }
        .copyBtn {
            display: block;
            margin-left: auto;
            min-width:42px;
            transition: all .3s;
        }
        #customer-repro-steps-info li:first-child, #internal-repro-steps-info li:first-child {
            margin-top: 0;
        }
        #customer-repro-steps-data, #internal-repro-steps-data {
            max-width: 580px;
            margin-left:auto;
        }
        .col-auto label {
            line-height: 38px;
        }
        .completed {
            opacity: 0.6;
        }
        #case-note li {
            transition: all .3s;
        }
    </style>
</head>
<body>
<div class="main">
    <div class="row m-0 p-0">
        <!-- FORM Column -->
        <div class="col-sm-12 col-md-7 p-5 pt-4 form-panel">
            <h1 class="text-title-medium-70 tp-title" style="color: white!important;-webkit-text-fill-color: white;margin-bottom:20px;background-image:none;">
                <i class="fa-brands fa-microsoft"></i> Microsoft Scoping
            </h1>
            <main>
                <p>#### FORM ####</p>
                <ol>
                    <!-- Issue Description Form -->
                    <li id="issue-description"></li>
                    <!-- Scope Agreement Form -->
                    <li id="scope-agreement"></li>
                    <li><label class="control-label fw-bold p-1">General scoping:</label>
                        <ul>
                            <!-- Issue Started Form -->
                            <li id="first-occurance"></li>
                            <!-- Did It Work Before Form -->
                            <li id="worked-before"></li>
                            <!-- Can Be Reprod On Demand Form -->
                            <li id="ondemand-repro"></li>
                            <!-- Can Be Reprod Internally -->
                            <li id="internal-repro"></li>
                            <!-- Customer Repro Steps Form -->
                            <li id="customer-repro-steps"></li>
                            <li id="customer-repro-steps-comment"></li>
                            <!-- Internal Repro Steps Form -->
                            <li id="internal-repro-steps"></li>
                            <li id="internal-repro-steps-comment"></li>
                            <div class="clearfix"></div>
                            <!-- How Many Affected Users Form -->
                            <li id="affected-users"></li>
                            <!-- Example Affected User Form -->
                            <li id="example-affected"></li>
                            <!-- Example Not Affected User Form -->
                            <li id="example-not-affected"></li>
                            <!-- Get-CsOnlineUser Transcript Form -->
                            <li>
                                <div class="row">
                                    <div id="get-csonlineuser-transcript" class="col-auto"></div>
                                    <div class="col-auto">
                                        <button class="btn-sm btn-link" style="margin:2px 0 0 -35px;" type="button" data-bs-toggle="modal" data-bs-target="#getCsOnlineUserModal"><i class="fa-solid fa-circle-info"></i></button>
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                            </li>
                        </ul>
                    </li>
                    <!-- PSTN or teams -->
                    <li>
                        <div class="row">
                            <div id="calling-scoping" class="col-auto"></div>
                            <div class="col-auto">
                                <button class="btn-sm btn-link" style="margin:2px 0 0 -35px;" type="button" data-bs-toggle="modal" data-bs-target="#getCsOnlineUserModal"><i class="fa-solid fa-circle-info"></i></button>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                        <ul id="calling-scoping-ul">
                            <li id="pstn-teams-call-kind"></li>
                            <li id="calling-plan-license"></li>
                            <li id="sbc-vendor"></li>
                            <li id="sbc-model"></li>
                            <li id="sbc-software"></li>
                        </ul>
                    </li>
                </ol>
            </main>
        </div>
            
        <!-- Case Note Column -->
        <div class="col-sm-12 col-md-5 p-5">
            
            <!-- Copy Button -->
            <button id="copy-case-note" class="btn btn-primary copyBtn"><i class="fa-solid fa-copy"></i></button>

            <!-- Case Note Start -->
            <div id="case-note">
                <p>#### REPORT ####</p>
                <p>Case status:</p>
                <p>Activity:</p>

                <ol style="margin-left:30px;">
                    <li>
                        Issue Description:
                        <ul><li id="issue-description-info"></li></ul>
                    </li>
                    <li>
                        Scope Agreement:
                        <ul><li id="scope-agreement-info"></li></ul>
                    </li>
                    <li>Scope:
                        <ul>
                            <li>
                                Behaviour started: <span id="first-occurance-info" class="min-width-10" data-text=""></span>
                                <ul>
                                    <li id="worked-before-info"></li>
                                    <li id="ondemand-repro-info"></li>
                                    <li id="internal-repro-info"></li>
                                </ul>
                            </li>
                            <li>
                                <p class="mb-0">Customer repro steps:</p>
                                <ol id="customer-repro-steps-info" style="margin-top: 0; padding-top: 0;" start="1"></ol>
                                <ul><li>Additional comments:<br><i id="customer-repro-steps-comment-info"></i></li></ul>
                            </li>
                            <li id="internal-repro-section">
                                <p class="mb-0">Internal repro steps:</p>
                                <ol id="internal-repro-steps-info" style="margin-top: 0; padding-top: 0;" start="1"></ol>
                                <ul><li>Additional comments:<br><i id="internal-repro-steps-comment-info"></i></li></ul>
                            </li>
                            <li>
                                <span id="affected-users-info" class="min-width-10" data-text=""></span> affected users
                                <ul>
                                    <li>Example Affected:
                                        <ul><li id="example-affected-info"></li></ul>
                                    </li>
                                </ul>
                                <ul>
                                    <li>Example Not Affected:
                                        <ul><li id="example-not-affected-info"></li></ul>
                                    </li>
                                </ul>
                                <ul><li id="get-csonlineuser-transcript-info"></li></ul>
                            </li>
                        </ul>
                    </li>
                    <li id="calling-scoping-section"><span id="calling-scoping-info"></span>
                        <ul>
                            <li id="pstn-teams-call-kind-info"></li>
                            <li id="calling-plan-license-info"></li>
                            <li id="sbc-vendor-info"></li>
                            <li id="sbc-model-info"></li>
                            <li id="sbc-software-info"></li>
                        </ul>
                    </li>
                </ol>
                <p>Action on Cx:</p>
                <p>Next contact:</p>
                <p>Next actions:</p>
                <p>##################</p>
            </div>
            <!-- Case Note End -->
        </div>
    </div>
</div>




<!-- Modals -->

    <!-- Get-CsOnlineUser -->
    <div class="modal fade" id="getCsOnlineUserModal" tabindex="-1" aria-labelledby="getCsOnlineUserModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="getCsOnlineUserModalLabel">Get-CsOnlineUser Trascript</h5>
              
              <button type="button" class="btn btn-primary copyBtn me-2" id="copy-getCsOnlineUser-transcript"><i class="fa-solid fa-copy"></i></button>
              <button type="button" class="btn-close m-0" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="getCsOnlineUser-transcript">
                <ul>
                    <li>[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12</li>
                    <li>Set-ExecutionPolicy RemoteSigned</li>
                    <li>Start-Transcript -Path "$env:userprofile\Desktop\CsOnlineUser-PS.txt" -NoClobber</li>
                    <li>Install-Module MicrosoftTeams</li>
                    <li>Connect-MicrosoftTeams</li>
                    <li>Get-CsOnlineUser affectedUser@contoso.com</li>
                    <li>Get-CsOnlineUser notAffectedUser@contoso.com</li>
                    <li>Stop-Transcript </li>
                </ul>
            </div>
          </div>
        </div>
      </div>


<!-- jQuery bundle -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<!-- Bootstrap bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

<!-- Custom scripts -->
<script type="text/javascript">
                                  
// Build template
    // Data Inputs
    createScopeQuestion('issue-description', true, 'Issue Description:', 'text', 'Inbound call not working');

    createScopeQuestion('scope-agreement', true, 'Scope Agreement:', 'text', 'Inbound calls working');
    
    var today = new Date(),
        date =  today.getFullYear() + '-'+ ('0' + (today.getMonth()+1)).slice(-2) + '-'+ ('0' + today.getDate()).slice(-2);
    createScopeQuestion('first-occurance', false, 'Behaviour observed for the first time:', 'date', date);

    var workedBeforeOptions = [
        ["It worked before", "Yes"],
        ["It never worked", "No"]
    ];
    createScopeQuestion('worked-before', true, 'Did it work before?', 'select', "Choose option", workedBeforeOptions);

    var ondemandReproOptions = [
        ["It can be reproduced on demand", "Yes"],
        ["Issue is not regular, difficult to reproduce", "Irregular, hard to repro"],
        ["It cannot be reproduced on demand", "No"]
    ];
    createScopeQuestion('ondemand-repro', true, 'Can customer reproduce problem on demand?', 'select', "Choose option", ondemandReproOptions);

    var internalReproOptions = [
        ["It can be reproduced in test envoirnment", "Yes"],
        ["It cannot be reproduced in test envoirnment", "No"]
    ];
    createScopeQuestion('internal-repro', true, 'Can you reproduce problem in test envoirnment?', 'select', "Choose option", internalReproOptions);
    // Hide internal repro if n/a
    collapseElement(['internal-repro-steps', 'internal-repro-steps-comment', 'internal-repro-section']);
    internalReproSelect = document.getElementById("internal-repro-data");
    internalReproSelect.addEventListener("change", function() {
        if(internalReproSelect.value == "0" || internalReproSelect.value == "It cannot be reproduced in test envoirnment") {
            collapseElement(['internal-repro-steps', 'internal-repro-steps-comment', 'internal-repro-section']);
        } else {
            expandElement(['internal-repro-steps', 'internal-repro-steps-comment', 'internal-repro-section']);
        }
    });

    createStepList('customer-repro-steps', 'Customer repro steps:', "Customer repro step");

    createScopeQuestion('customer-repro-steps-comment', false, 'Additional comments about customer repro:', 'textarea', 'In comparison to web client...');

    createStepList('internal-repro-steps', 'Internal repro steps:', "Internal repro step");

    createScopeQuestion('internal-repro-steps-comment', false, 'Additional comments about internal repro:', 'textarea', 'In comparison to customer repro...');

    createScopeQuestion('affected-users', false, 'How many affected users:', 'text', 'All, 10, ~100');

    createScopeQuestion('example-affected', true, 'Example affected user:', 'text', 'affected@contoso.com');

    createScopeQuestion('example-not-affected', true, 'Example not affected user:', 'text', 'notAffected@contoso.com');

    createScopeQuestion('get-csonlineuser-transcript', true, 'Get-CsOnlineUser Transcript Attached?', 'checkbox', 'Get-CsOnlineUser Transcript Attached');

    createScopeQuestion('calling-scoping', true, 'Calling scoping:', 'checkbox', 'Calling scoping:');
    collapseElement(['calling-scoping-ul', 'calling-scoping-section']);
    callingScopingCheck = document.getElementById("calling-scoping-data");
    callingScopingCheck.addEventListener("input", function() {
        if(callingScopingCheck.checked == false) {
            collapseElement(['calling-scoping-ul', 'calling-scoping-section']);
        } else {
            expandElement(['calling-scoping-ul', 'calling-scoping-section']);
        }
    });

    var affectedCallsOptions = [
        ["Direct Routing Inbound", "Direct Routing Inbound"],
        ["Direct Routing Outbound", "Direct Routing Outbound"],
        ["Direct Routing Inbound & Outbound", "Direct Routing Inbound & Outbound"],
        ["Calling Plan Inbound", "Calling Plan Inbound"],
        ["Calling Plan Outbound", "Calling Plan Outbound"],
        ["Calling Plan Inbound & Outbound", "Calling Plan Inbound & Outbound"],
        ["Teams calls, no PSTN", "Teams to Teams calls, no PSTN"]
    ];
    createScopeQuestion('pstn-teams-call-kind', true, 'What kind of calls are affected?', 'select', 'Choose option', affectedCallsOptions);
    callKindSelect = document.getElementById("pstn-teams-call-kind-data");
    callKindSelect.addEventListener("change", function() {
        if(callKindSelect.value == "0") {
            collapseElement(['calling-plan-license', 'calling-plan-license-info','sbc-vendor', 'sbc-vendor-info','sbc-model', 'sbc-model-info', 'sbc-software', 'sbc-software-info']);
        } else if (callKindSelect.value == "Direct Routing Inbound" || callKindSelect.value == "Direct Routing Outbound" || callKindSelect.value == "Direct Routing Inbound & Outbound") {
            collapseElement(['calling-plan-license', 'calling-plan-license-info']);
            expandElement(['sbc-vendor', 'sbc-model', 'sbc-software']);
        } else if (callKindSelect.value == "Calling Plan Inbound" || callKindSelect.value == "Calling Plan Outbound" || callKindSelect.value == "Calling Plan Inbound & Outbound") {
            expandElement(['calling-plan-license']);
            collapseElement(['sbc-vendor', 'sbc-vendor-info', 'sbc-model', 'sbc-model-info', 'sbc-software', 'sbc-software-info']);
        } else if (callKindSelect.value == "Teams calls, no PSTN") {
            collapseElement(['calling-plan-license', 'calling-plan-license-info', 'sbc-vendor', 'sbc-vendor-info', 'sbc-model-info', 'sbc-model', 'sbc-software', 'sbc-software-info']);
        }
    });
    
    var callingPlanOptions = [
        ["Domestic Calling Plan", "Domestic Calling Plan"],
        ["International Calling Plan", "International Calling Plan"],
        ["Domestic and International Calling Plan", "Domestic and International Calling Plan"]
    ];
    createScopeQuestion('calling-plan-license', true, 'What Calling Plan has affected user?', 'select', 'Choose plan', callingPlanOptions);
    collapseElement(['calling-plan-license']);

    var SBCVendorOptions = [
        ["AudioCodes", "AudioCodes"],
        ["Ribbon Communications", "Ribbon Communications"],
        ["Thinktel", "Thinktel"],
        ["Oracle", "Oracle"],
        ["TE-SYSTEMS", "TE-SYSTEMS"],
        ["Metaswitch", "Metaswitch"],
        ["Cisco", "Cisco"],
        ["Avaya", "Avaya"],
        ["Nokia", "Nokia"],
        ["Italtel", "Italtel"],
        ["Ericsson", "Ericsson"],
        ["Cataleya", "Cataleya"],
        ["ULTATEL", "ULTATEL"],
        ["Atos", "Atos"],
        ["Sansay Inc.", "Sansay Inc."],
        ["Enghouse Networks", "Enghouse Networks"],
        ["Patton Electronics Co.", "Patton Electronics Co."],
        ["M5 Technologies (Media5 Corporation)", "M5 Technologies (Media5 Corporation)"],
        ["Ekinops", "Ekinops"],
        ["46 Labs LLC", "46 Labs LLC"],
        ["Frafos", "Frafos"]
    ];
    createScopeQuestion('sbc-vendor', true, 'SBC Vendor:', 'select', 'Choose vendor', SBCVendorOptions, 'SBC Vendor:');
    SBCModelOptions = []
    createScopeQuestion('sbc-model', true, 'SBC Model:', 'select', 'Choose vendor', SBCModelOptions, 'SBC Model:');
    collapseElement(['sbc-vendor', 'sbc-model', 'sbc-software']);
    SBCVendorSelect = document.getElementById("sbc-vendor-data");
    SBCModelSelect = document.getElementById("sbc-model-data");
    SBCModelNoteLi = document.getElementById("sbc-model-info");
    SBCVendorSelect.addEventListener("change", function() {
        if (SBCVendorSelect.value == "0") {
            selectOptions = ""
            SBCModelOptions = [
                ["0", "Choose vendor"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "AudioCodes") {
            selectOptions = ""
            SBCModelOptions = [
                ["0", "Choose model"],
                ["Mediant 500 SBC", "Mediant 500 SBC"],
                ["Mediant 800 SBC", "Mediant 800 SBC"],
                ["Mediant 2600 SBC", "Mediant 2600 SBC"],
                ["Mediant 4000 SBC", "Mediant 4000 SBC"],
                ["Mediant 1000B SBC", "Mediant 1000B SBC"],
                ["Mediant 9000 SBC", "Mediant 9000 SBC"],
                ["Mediant Virtual Edition SBC", "Mediant Virtual Edition SBC"],
                ["Mediant Cloud Edition SBC", "Mediant Cloud Edition SBC"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Ribbon Communications") {
            selectOptions = ""
            SBCModelOptions = [
                ["0", "Choose model"],
                ["SBC 5100/5110", "SBC 5100/5110"],
                ["SBC 5200/5210", "SBC 5200/5210"],
                ["SBC 5400", "SBC 5400"],
                ["SBC 7000", "SBC 7000"],
                ["SBC SWe", "SBC SWe"],
                ["SBC 1000", "SBC 1000"],
                ["SBC 2000", "SBC 2000"],
                ["SBC SWe Lite", "SBC SWe Lite"],
                ["EdgeMarc Series", "EdgeMarc Series"],
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Thinktel") {
            selectOptions = ""
            SBCModelOptions = [
                ["Think 365 SBC", "Think 365 SBC"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Oracle") {
            selectOptions = ""
            SBCModelOptions = [
                ["0", "Choose model"],
                ["AP 1100", "AP 1100"],
                ["AP 3900", "AP 3900"],
                ["AP 4600", "AP 4600"],
                ["AP 6300", "AP 6300"],
                ["AP 6350", "AP 6350"],
                ["VME", "VME"],
                ["AP 3950", "AP 3950"],
                ["AP 4900", "AP 4900"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "TE-SYSTEMS") {
            selectOptions = ""
            SBCModelOptions = [
                ["anynode", "anynode"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Metaswitch") {
            selectOptions = ""
            SBCModelOptions = [
                ["Perimeta SBC", "Perimeta SBC"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '<option value="'+item[0]+'">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Cisco") {
            selectOptions = ""
            SBCModelOptions = [
                ["0", "Choose model"],
                ["Cisco Unified Border Element (CUBE) for 1000 Series Integrated Services Routers", "Cisco Unified Border Element (CUBE) for 1000 Series Integrated Services Routers"],
                ["Cisco Unified Border Element (CUBE) for 4000 Series Integrated Services Routers", "Cisco Unified Border Element (CUBE) for 4000 Series Integrated Services Routers"],
                ["Cisco Unified Border Element (CUBE) for 1000V Series Cloud Services Router", "Cisco Unified Border Element (CUBE) for 1000V Series Cloud Services Router"],
                ["Cisco Unified Border Element (CUBE) for 1000 Series Aggregation Services Routers", "Cisco Unified Border Element (CUBE) for 1000 Series Aggregation Services Routers"],
                ["Cisco Unified Border Element (CUBE) for Catalyst 8000 Edge Platforms", "Cisco Unified Border Element (CUBE) for Catalyst 8000 Edge Platforms"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Avaya") {
            selectOptions = ""
            SBCModelOptions = [
                ["Avaya Session Border Controller for Enterprise (ASBCE)", "Avaya Session Border Controller for Enterprise (ASBCE)"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Nokia") {
            selectOptions = ""
            SBCModelOptions = [
                ["Nokia Session Border Controller", "Nokia Session Border Controller"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Italtel") {
            selectOptions = ""
            SBCModelOptions = [
                ["NetMatch-S CI", "NetMatch-S CI"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Ericsson") {
            selectOptions = ""
            SBCModelOptions = [
                ["vSBC 2.16", "vSBC 2.16"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Cataleya") {
            selectOptions = ""
            SBCModelOptions = [
                ["Orchid Link", "Orchid Link"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "ULTATEL") {
            selectOptions = ""
            SBCModelOptions = [
                ["Teams SBC", "Teams SBC"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Atos") {
            selectOptions = ""
            SBCModelOptions = [
                ["Atos Unify OpenScape Session Border Controller", "Atos Unify OpenScape Session Border Controller"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Sansay Inc") {
            selectOptions = ""
            SBCModelOptions = [
                ["vmVSXi", "vmVSXi"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Enghouse Networks") {
            selectOptions = ""
            SBCModelOptions = [
                ["Dialogic BorderNet SBC", "Dialogic BorderNet SBC"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Patton Electronics Co.") {
            selectOptions = ""
            SBCModelOptions = [
                ["Patton SmartNode eSBC", "Patton SmartNode eSBC"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "M5 Technologies (Media5 Corporation)") {
            selectOptions = ""
            SBCModelOptions = [
                ["Mediatrix Sentinel Series", "Mediatrix Sentinel Series"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Ekinops") {
            selectOptions = ""
            SBCModelOptions = [
                ["0", "Choose model"],
                ["Ekinops Session Border Controller (ONeSBC)", "Ekinops Session Border Controller (ONeSBC)"],
                ["Ekinops Virtual Session Border Controller (ONEvSBC)", "Ekinops Virtual Session Border Controller (ONEvSBC)"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "46 Labs LLC") {
            selectOptions = ""
            SBCModelOptions = [
                ["Hyperconverged Voice", "Hyperconverged Voice"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        } else if (SBCVendorSelect.value == "Frafos") {
            selectOptions = ""
            SBCModelOptions = [
                ["ABC SBC", "ABC SBC"]
            ]
            for (var item of SBCModelOptions) {
                selectOptions += '"<option value="' + item[0] + '">' + item[1] + '</option>';
            }
            SBCModelSelect.innerHTML = selectOptions;
            SBCModelSelect.dispatchEvent(new Event('change'));
        }
    });

    createScopeQuestion('sbc-software', true, 'SBC Software Version:', 'text', '7.20A.258', '', 'Software version:');

    // Copy Buttons
    copyText('copy-case-note', 'case-note');

    copyText('copy-getCsOnlineUser-transcript', 'getCsOnlineUser-transcript');


// Functions         
function createScopeQuestion(liID, hideLi, label, inputType, placeholder, options, prepend) {

    // Check the input type and set correct element
        if (inputType == "text" || inputType == "date" || inputType == "checkbox") {
                element = 'input';
        } else if(inputType == "select") {
                element = 'select';
        } else if(inputType == "textarea") {
                element = 'textarea';
        }

    // Create elements
    const   scopeLi = document.getElementById(liID),
            scopeLiNote = document.getElementById(liID + "-info"),
            scopeLiRow = document.createElement("div"),
            scopeLiColLabel = document.createElement("div"),
            scopeLiColInfo = document.createElement("div"),
            scopeLiLabel = document.createElement("label"),
            scopeLiRowClearFix = document.createElement("div"),
            scopeLiInfo = document.createElement(element);
            

    // Set attributes
        scopeLiRow.setAttribute("class", 'row p-1');
        scopeLiColLabel.setAttribute("class", 'col-auto');
        scopeLiColInfo.setAttribute("class", 'col');
        scopeLiLabel.setAttribute("class", 'control-label fw-bold');
        scopeLiLabel.setAttribute("for", liID + '-data');
        scopeLiLabel.innerHTML = label;
        scopeLiRowClearFix.setAttribute("class", 'clearfix');
        scopeLiInfo.setAttribute("class", 'form-control border-danger');
        scopeLiInfo.setAttribute("id", liID + '-data');
        if (inputType == "text") {
            scopeLiInfo.setAttribute("type", "text");
            scopeLiInfo.setAttribute("placeholder",  placeholder);
        } else if(inputType == "date") {
            scopeLiInfo.setAttribute("type", "date");
            scopeLiInfo.setAttribute("value",  placeholder);
        } else if(inputType == "select") {
            scopeLiInfo.classList.remove("form-control");
            scopeLiInfo.classList.add("form-select");
            scopeLiInfo.setAttribute("type", "date");
            scopeLiInfo.setAttribute("value",  placeholder);
        } else if(inputType == "textarea") {
            scopeLiInfo.setAttribute("rows", 3);
            scopeLiInfo.setAttribute("placeholder",  placeholder);
        } else if(inputType == "checkbox") {
            scopeLiColInfo.classList.add('form-check', 'form-switch', 'p-0');
            scopeLiInfo.classList.remove("form-control");
            scopeLiInfo.classList.add("form-check-input");
            scopeLiInfo.setAttribute("style", "margin:12px 0 0 10px;");
            scopeLiInfo.setAttribute("type", "checkbox");
            scopeLiInfo.setAttribute("role", "switch");
        }

        
        if(hideLi == true) {
            scopeLiNote.style.overflow = 'hidden';
            scopeLiNote.style.maxHeight = 0;
            scopeLiNote.style.opacity = 0;
        }


    // Add listeners
        if(inputType == "text" || inputType == "textarea") {
            scopeLiInfo.addEventListener("input", function () {
                scopeLiNote.setAttribute('data-text', scopeLiInfo.value);
                if ((scopeLiInfo.value).length === 0) {
                    scopeLiLabel.classList.remove("completed");
                    scopeLiInfo.classList.add("border-danger");
                    scopeLiInfo.classList.remove("border-success");
                    scopeLiNote.innerHTML = '';
                    if(hideLi == true) {
                        scopeLiNote.style.overflow = 'hidden';
                        scopeLiNote.style.maxHeight = 0;
                        scopeLiNote.style.opacity = 0;
                    }
                } else {
                    scopeLiLabel.classList.add("completed");
                    scopeLiInfo.classList.add("border-success");
                    scopeLiInfo.classList.remove("border-danger");
                    if (prepend) {
                        scopeLiNote.innerHTML = prepend + " " + scopeLiNote.getAttribute('data-text');
                    } else {
                        scopeLiNote.innerHTML = scopeLiNote.getAttribute('data-text');
                    }
                    if(hideLi == true) {
                        scopeLiNote.style.maxHeight = scopeLiNote.scrollHeight + "px";
                        scopeLiNote.style.overflow = 'visible';
                        scopeLiNote.style.opacity = 1;
                    }
                }
            });
        } else if(inputType == "date") {
            scopeLiInfo.addEventListener("input", function () {
                scopeLiNote.setAttribute('data-text', scopeLiInfo.value);
                if ((scopeLiInfo.value).length === 0) {
                    scopeLiLabel.classList.remove("completed");
                    scopeLiInfo.classList.add("border-danger");
                    scopeLiInfo.classList.remove("border-success");
                    scopeLiNote.innerHTML = '';
                    if(hideLi == true) {
                        scopeLiNote.style.overflow = 'hidden';
                        scopeLiNote.style.maxHeight = 0;
                        scopeLiNote.style.opacity = 0;
                    }
                } else {
                    var date = new Date(scopeLiNote.getAttribute('data-text')),
                    noteDate = ('0' + date.getDate()).slice(-2) + '/' + ('0' + (date.getMonth()+1)).slice(-2) + '/' + date.getFullYear();
                    scopeLiLabel.classList.add("completed");
                    scopeLiInfo.classList.add("border-success");
                    scopeLiInfo.classList.remove("border-danger");
                    if (prepend) {
                        scopeLiNote.innerHTML = prepend + " " + noteDate;
                    } else {
                        scopeLiNote.innerHTML = noteDate;
                    }
                    if(hideLi == true) {
                        scopeLiNote.style.maxHeight = scopeLiNote.scrollHeight + "px";
                        scopeLiNote.style.overflow = 'visible';
                        scopeLiNote.style.opacity = 1;
                    }
                }
            });
        } else if(inputType == "select") {
            scopeLiInfo.addEventListener("change", function () {
                scopeLiNote.setAttribute('data-text', scopeLiInfo.value);
                if (scopeLiInfo.value === "0") {
                    scopeLiLabel.classList.remove("completed");
                    scopeLiInfo.classList.add("border-danger");
                    scopeLiInfo.classList.remove("border-success");
                    scopeLiNote.innerHTML = '';
                    if(hideLi == true) {
                        scopeLiNote.style.overflow = 'hidden';
                        scopeLiNote.style.maxHeight = 0;
                        scopeLiNote.style.opacity = 0;
                    }
                } else {
                    scopeLiLabel.classList.add("completed");
                    scopeLiInfo.classList.add("border-success");
                    scopeLiInfo.classList.remove("border-danger");
                    if (prepend) {
                        scopeLiNote.innerHTML = prepend + " " + scopeLiNote.getAttribute('data-text');
                    } else {
                        scopeLiNote.innerHTML = scopeLiNote.getAttribute('data-text');
                    }
                    if(hideLi == true) {
                        scopeLiNote.style.maxHeight = scopeLiNote.scrollHeight + "px";
                        scopeLiNote.style.overflow = 'visible';
                        scopeLiNote.style.opacity = 1;
                    }
                }
            });
        } else if(inputType == "checkbox") {
            scopeLiInfo.addEventListener("input", function () {
                if (scopeLiInfo.checked == false) {
                    scopeLiLabel.classList.remove("completed");
                    scopeLiInfo.classList.add("border-danger");
                    scopeLiInfo.classList.remove("border-success");
                    scopeLiNote.innerHTML = '';
                    if(hideLi == true) {
                        scopeLiNote.style.overflow = 'hidden';
                        scopeLiNote.style.maxHeight = 0;
                        scopeLiNote.style.opacity = 0;
                    }
                } else {
                    scopeLiLabel.classList.add("completed");
                    scopeLiInfo.classList.add("border-success");
                    scopeLiInfo.classList.remove("border-danger");
                    scopeLiNote.innerHTML = placeholder;
                    if(hideLi == true) {
                        scopeLiNote.style.maxHeight = scopeLiNote.scrollHeight + "px";
                        scopeLiNote.style.overflow = 'visible';
                        scopeLiNote.style.opacity = 1;
                    }
                }
            });
        }

    // Append elements
        scopeLi.appendChild(scopeLiRow);
        scopeLiRow.appendChild(scopeLiColLabel);
        scopeLiRow.appendChild(scopeLiColInfo);
        scopeLiColLabel.appendChild(scopeLiLabel);
        scopeLiColInfo.appendChild(scopeLiInfo);
        scopeLiRow.appendChild(scopeLiRowClearFix);
        
        if(inputType == "select") {
            option = document.createElement("option");
            option.setAttribute("value", 0);
            option.innerHTML = placeholder
            scopeLiInfo.appendChild(option);
            options.forEach((element) => {
                option = document.createElement("option");
                option.setAttribute("value", element[0]);
                option.innerHTML = element[1];
                scopeLiInfo.appendChild(option);
            });
            
        }
}

function createStepList(liID, label, placeholder, options) {
    var   stepId = 1;
    // Create elements
    const   stepList = document.getElementById(liID),
            stepListNote = document.getElementById(liID + '-info'),
            
            stepListLiRow = document.createElement("div"),
            stepListLiColLabel = document.createElement("div"),
            stepListLiColSteps = document.createElement("div"),
            stepListLiLabel = document.createElement("label"),
            stepListLiSteps = document.createElement("ol"),
            stepLiAddStepButton = document.createElement("button"),
            stepListLiRowClearFix = document.createElement("div");
            
    // Set attributes
        stepLiAddStepButton.setAttribute('class', 'btn btn-link float-end mt-1');
        stepLiAddStepButton.innerHTML = '<i class="fa-solid fa-plus"></i>'
        stepListLiRow.setAttribute("class", 'row p-1');
        stepListLiColLabel.setAttribute("class", 'col-auto');
        stepListLiColSteps.setAttribute("class", 'col py-4');
        stepListLiLabel.setAttribute("class", 'control-label fw-bold');
        stepListLiLabel.setAttribute("for", liID + '-data');
        stepListLiLabel.innerHTML = label;
        stepListLiRowClearFix.setAttribute("class", 'clearfix');
        stepListLiSteps.setAttribute("id", liID + '-data');

    // Add step function
        stepLiAddStepButton.addEventListener("click", function () {
            // Create step elements
            const stepLi = document.createElement("li"),
            stepLiRow = document.createElement("div"),
            stepLiColStep = document.createElement("div"),
            stepLiColButton = document.createElement("div"),
            stepLiInput = document.createElement("input"),
            stepLiButton = document.createElement("button"),
            stepLiNote = document.createElement("li"),
            stepLiRowClearFix = document.createElement("div");


            // Set attributes
            stepLi.setAttribute("id", liID+'-step-'+stepId);
            stepLiRow.setAttribute("class", 'row my-1');
            stepLiColStep.setAttribute("class", 'col');
            stepLiColButton.setAttribute("class", 'col-auto');
            stepLiInput.setAttribute("class", 'form-control border-danger');
            stepLiInput.setAttribute("placeholder",  placeholder);
            stepLiButton.setAttribute("class", 'btn btn-link');
            stepLiButton.innerHTML = '<i class="fa-solid fa-trash-can"></i>';
            stepLiRowClearFix.setAttribute("class", 'clearfix');

            // Add step listeners
            stepLiInput.addEventListener("input", function () {
                        stepLiNote.setAttribute('data-text', stepLiInput.value);
                        if ((stepLiInput.value).length === 0) {
                            stepLi.classList.add("text-danger");
                            stepLi.classList.remove("text-success");
                            stepLiInput.classList.add("border-danger");
                            stepLiInput.classList.remove("text-success");
                            stepListLiLabel.classList.remove('completed')
                            stepLiNote.innerHTML = '';
                        } else {
                            stepLi.classList.add("text-success");
                            stepLi.classList.remove("text-danger");
                            stepLiInput.classList.add("border-success");
                            stepLiInput.classList.remove("border-danger");
                            stepListLiLabel.classList.add('completed')
                            stepLiNote.innerHTML = stepLiNote.getAttribute('data-text');
                        }
                    });
                    stepLiButton.addEventListener("click", function () {
                            stepLi.remove();
                            stepLiNote.remove();
                    });
            // Append step elements
            stepLi.appendChild(stepLiRow);
            stepLiRow.appendChild(stepLiColStep);
            stepLiRow.appendChild(stepLiColButton);
            stepLiColStep.appendChild(stepLiInput);
            stepLiColButton.appendChild(stepLiButton);
            stepLiRow.appendChild(stepLiRowClearFix);
            stepListLiSteps.appendChild(stepLi);
            stepListNote.appendChild(stepLiNote);
            
            // Increase step counter
            stepId++
        });

        stepLiAddStepButton.click();
        stepLiAddStepButton.click();
        stepLiAddStepButton.click();
        
    // Append elements
        stepList.appendChild(stepListLiRow);
        stepListLiRow.appendChild(stepListLiColLabel);
        stepListLiRow.appendChild(stepListLiColSteps);
        stepListLiColLabel.appendChild(stepListLiLabel);
        stepListLiColSteps.appendChild(stepListLiSteps);
        stepListLiColSteps.appendChild(stepLiAddStepButton);
        stepListLiRow.appendChild(stepListLiRowClearFix);
}

// Copy Text Logic
    function copyText(btnID, divID) {
        const button = document.getElementById(btnID),
        content = document.getElementById(divID);

        button.addEventListener("click", function () {
            
            if (window.getSelection) {
                var range = document.createRange();
                window.getSelection().removeAllRanges();
                range.selectNode(content);
                window.getSelection().addRange(range);
                document.execCommand("copy");
                window.getSelection().removeAllRanges();
            }

            var last = this.innerHTML;
            if (last == '<i class="fa-solid fa-copy"></i>') {
                this.classList.add("btn-success");
                this.classList.remove("btn-primary");
                this.innerHTML = '<i class="fa-solid fa-check"></i>';
                setTimeout(function () {
                    this.classList.add("btn-primary");
                    this.classList.remove("btn-success");
                    this.innerHTML = last;
                }.bind(this), 1000);
            }
        })
    }

// Collapse
    function collapseElement(elementID) {
        if (typeof elementID === 'string' || elementID instanceof String) {
            element = document.getElementById(elementID);
            element.style.transition = 'all .3s';
            element.style.overflow = 'hidden';
            element.style.maxHeight = 0;
            element.style.opacity = 0;
        }
        else if (isArray(elementID)) {
            elementID.forEach(function (element) {
                if (typeof element === 'string' || element instanceof String) {
                    element = document.getElementById(element);
                    element.style.transition = 'all .3s';
                    element.style.overflow = 'hidden';
                    element.style.maxHeight = 0;
                    element.style.opacity = 0;
                } else {
                    element.style.transition = 'all .3s';
                    element.style.overflow = 'hidden';
                    element.style.maxHeight = 0;
                    element.style.opacity = 0;
                }
            });
        } else {
            elementID.style.transition = 'all .3s';
            elementID.style.overflow = 'hidden';
            elementID.style.maxHeight = 0;
            elementID.style.opacity = 0;
        }
    }
    function expandElement(elementID) {
        if (typeof elementID === 'string' || elementID instanceof String) {
            element = document.getElementById(elementID);
            element.style.maxHeight = element.scrollHeight + "px";
            element.style.transition = 'all .3s';
            element.style.overflow = 'visible';
            element.style.opacity = 1;
        } else if (isArray(elementID)) {
            elementID.forEach(function (element) {
                if (typeof element === 'string' || element instanceof String) {
                    element = document.getElementById(element);
                    element.style.maxHeight = element.scrollHeight + "px";
                    element.style.transition = 'all .3s';
                    element.style.overflow = 'visible';
                    element.style.opacity = 1;
                    setTimeout(function() {
                        element.style.maxHeight = null;
                    }, 300);
                } else {
                    element.style.maxHeight = element.scrollHeight + "px";
                    element.style.transition = 'all .3s';
                    element.style.overflow = 'visible';
                    element.style.opacity = 1;
                }
            });
        } else {
            elementID.style.maxHeight = element.scrollHeight + "px";
            elementID.style.transition = 'all .3s';
            element.style.overflow = 'visible';
            elementID.style.opacity = 1;
        }
    }
    function toggleElement(elementID) {
        element = document.getElementById(elementID);
        if(!element.style.maxHeight == 0) {
            element.style.maxHeight = 0;
            element.style.opacity = 0;
        } else {
            element.style.maxHeight = element.scrollHeight + "px";
            element.style.opacity = 1;
        }
    }
    function isArray(array) {
        return Object.prototype.toString.call(array) === '[object Array]';
    }
</script>
</body>
</html>